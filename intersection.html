<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js/libs/jquery-1.11.2.js"></script>
    <link rel="stylesheet" href="css/reasyui.css">
    <style>
        .container{
            width: 980px;
            height: 508px;
            background: #ccc;
        }
        .container-right{
            height: 35px;
        }
        .container-right li{
            float: left;
            padding: 5px;
            margin-right: 12px;
            margin-bottom: 10px;
            font-size: 20px;
            list-style: none;
        }
        .street {
            width: 905px;
            height: 450px;
            float: left;
            position: relative;
            background: #0086b3;
            background:url(img/st.jpg) no-repeat  right;
        }
        .street li{
            padding: 5px;
            margin-right: 12px;
            margin-bottom: 10px;
            font-size: 16px;
            list-style: none;
        }
        .street input {
            width: 15%;
        }
        /*.street-b {
            position: absolute;
            top: 15.5%;
        }*/
        .result {
            margin-left: 5%;
            width: 24.5%;
            height: 50%;
            background: white;
            overflow: scroll;
        }
        .result p{
            margin-left: 5%;
            margin-top: 5%;
        }
        .p01001,.p01002,.p01003,.p01004,.p01005,.p01006,.p01007,.p01008,.p01009,.p01010,.p01011,.p01012,.p01013,.p01014,.p01015,.p01016{
            position: absolute;
            font-size: 0;
        }
        .p01001 {
            top: 15.5%;
            left: 60.1%;
        }
        .p01002 {
            top: 15.5%;
            left: 62.5%;
        }
        .p01003 {
            top: 15.5%;
            left: 64.5%;
        }
        .p01004 {
            top: 15.5%;
            left: 66.7%;
        }
        .p01005 {
            top: 40%;
            left: 81.7%;
        }
        .p01006 {
            top: 45%;
            left: 81.7%;
        }
        .p01007 {
            top: 74.5%;
            left: 72.8%;
        }
        .p01008 {
            top: 74.5%;
            left: 70.8%;
        }
        .p01009{
            top: 74.5%;
            left: 68.5%;

        }
        .p01010 {
            top: 74.5%;
            left: 66.0%;
        }
        .p01011 {
            top: 56%;
            left: 51.5%;
        }
        .p01012 {
            top: 50%;
            left: 51.5%;
        }
        .p01013 {
            top: 29.5%;
            left: 60%;
        }
        .p01014 {
            top: 37.5%;
            left: 73.5%;
        }
        .p01015 {
            top: 62.5%;
            left: 60%;
        }
        .p01016 {
            top: 37%;
            left: 58%;
        }
    </style>
</head>
<body>
<div class="container">
    <div class="container-right">
        <ul class="channel-top">
            <li id="s00000">运行正常</li>
            <li id="s00001">GPS</li>
            <li id="s00002">中心对时</li>
            <li id="s00003">大灯开</li>
            <li id="s00004">2018-01-20 00:00:00</li>
        </ul>
    </div>
    <div class="street">
        <!--<div class="street-b">-->
            <ul class="channel-top">
                <li >路口名称：金桐东路-光华路</li>
                <li >IP&nbsp&nbsp地&nbsp&nbsp址：金桐东路</li>
                <li >所&nbsp属子区：金桐东路</li>
                <li >信&nbsp&nbsp号&nbsp&nbsp机：金桐东路</li>
                <li>
                    查询：<input type="text" id="search"><button type="button" onclick="search()">提交</button>
                </li>
            </ul>
            <div class="result" id="result"></div>
        <!--</div>-->
        <div class="row1">
            <div class="p01001" id="p01001">
                <img src="img/直行向下.png" alt="">
            </div>
            <div class="p01002" id="p01002">
                <img src="img/直行向下.png" alt="">
            </div>
            <div class="p01003" id="p01003">
                <img src="img/直行向下.png" alt="">
            </div>
            <div class="p01004" id="p01004">
                <img src="img/左转向下.png" alt="">
            </div>
        </div>
        <div class="row2">
            <div class="p01005" id="p01005"><img src="img/直行向左.png" alt=""></div>
            <div class="p01006" id="p01006"><img src="img/左转向左.png" alt=""></div>
        </div>
        <div class="row3">
            <div class="p01007" id="p01007">
                <img src="img/直行向上.png" alt="">
            </div>
            <div class="p01008" id="p01008">
                <img src="img/直行向上.png" alt="">
            </div>
            <div class="p01009" id="p01009">
                <img src="img/直行向上.png" alt="">
            </div>
            <div class="p01010" id="p01010">
                <img src="img/左转向上.png" alt="">
            </div>
        </div>
        <div class="row4">
            <div class="p01011" id="p01011">
                <img src="img/直行向右.png" alt="">
            </div>
            <div class="p01012" id="p01012">
                <img src="img/左转向右.png" alt="">
            </div>
        </div>
        <div class="row5">
            <div class="p01013" id="p01013">
                <img src="img/bzs.png" alt="">
            </div>
            <div class="p01014" id="p01014">
                <img src="img/bzy.png" alt="">
            </div>
            <div class="p01015" id="p01015">
                <img src="img/bzs.png" alt="">
            </div>
            <div class="p01016" id="p01016">
                <img src="img/bzy.png" alt="">
            </div>
        </div>
    </div>
</div>
<script>
    $(document).keydown(function(event){
        if(event.keyCode == 65){
            location.href="getdetector.html";
        }
        if(event.keyCode == 66){
            location.href="getlamp.html";
        }
    });
    function single(single_data) {
        var status = [];
        var a = single_data;
        console.log(single_data);

        status.push(
            {"s00000":a.s00000,"s00001":a.s00001,"s00002":a.s00002,"s00003":a.s00003},
            {"s00004":a.s00004}
        );
        $.each(status[0],function(key,item){
            switch (item)
            {
                case 0:
                    document.getElementById(key).style.background = "#0f0";
                    break;
                case 1:
                    document.getElementById(key).style.background = "#ccc";
                    break;
            }
        });
        $.each(status[1],function(key,item){
            document.getElementById(key).innerText =item;
        });
    }
    function fillDatas(rect_data) {
        $.each(rect_data,function(key,item){
            switch (item)
            {
                case 1:
                    document.getElementById(key).style.background = "#f00";
                    break;
                case 2:
                    document.getElementById(key).style.background = "#ff0";
                    // document.getElementById(key).style.background = "-moz-linear-gradient(left,#ccc,#0f0)";
                    break;
                case 3:
                    document.getElementById(key).style.background = "#0f0";
                    break;
            }
        })
    }
    var fun = function() {
        $.ajax({
            type: "POST",
            url: "/get_status",
            contentType: 'application/json',
            dataType: "json",
            success:function(data){
                single(data);
                console.log(data);
            },
            error:function(){
                console.log("加载资源失败");
            }
        });
        $.ajax({
            type: "POST",
            url: "/get_intersection",
            contentType: 'application/json',
            dataType: "json",
            success:function(data){
                fillDatas(data);
                console.log(data);
            },
            error:function(){
                console.log("加载资源失败");
            }
        });
    };
    setInterval(fun,1000);
    // 查询
    function search()
    {
        $.ajax({
            type: "POST",
            url: "/get_search",
            contentType: 'application/json',
            dataType: "json",
            data: $('#search').serialize(),
            success:function(data){
                searchreslut(data);
            },
            error: function(data, type, err){
                console.log("ajax错误类型："+type);
                console.log(err);
            }
        });

    }
    function searchreslut(rect_data) {
        var objKeys=Object.keys(rect_data);
        var objvalus=Object.values(rect_data);
        var str = "";
        for (var i =0; i<objKeys.length; i++)  {
            str += "<p>"+objKeys[i]+"<span>: </span><span >"+objvalus[i]+"</span></p>";
        }
        document.getElementById('result').innerHTML = str;
    }

</script>
</body>
</html>